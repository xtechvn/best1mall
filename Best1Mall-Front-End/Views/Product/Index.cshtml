 
@using Best1Mall_Front_End.Models.Products
@using Best1Mall_Front_End.ViewModels;
@using Best1Mall_Front_End.Utilities;
@model ProductListPageViewModel
@{
    ViewData["Title"] = "product";
    int productid_id = Model.SelectedGroupId;
    int productid_id2 = ViewBag.group_id;

    int? childrenId = ViewData["ChildrenId"] as int?; // Lấy children_id từ ViewData
   
}
<!-- Phần tử ẩn lưu group_id từ URL -->
<input type="hidden" id="group_id_from_url" value="@productid_id2" />

<main class="min-h-[40vh]">

        
<!-- DANH SACH SAN PHAM -->
<section class="product-section">
    <div class="max-w-[1230px] mx-auto my-4 px-[15px]">
        <!-- banner -->
        <img src="assets/images/banner1.jpg" alt="Banner 1" class="w-full h-auto shadow" />
        <!-- List Thương hiệu -->
        <div class="my-6 md:my-10">
            <!-- Swiper -->
            <div class="relative mt-3">
                <div class="brands-swiper">
                    <div class="swiper">
                        <div class="swiper-wrapper">
                            <!-- Slide Item -->
                            <div class="swiper-slide">
                                <a href="">
                                    <img src="assets/images/logo-th.png" alt=""
                                        class="w-full h-30 object-contain px-3 py-5 bg-white" />
                                </a>
                            </div>

                            <!-- Slide Item -->
                            <div class="swiper-slide">
                                <a href="">
                                    <img src="assets/images/logo-th.png" alt=""
                                        class="w-full h-30 object-contain px-3 py-5 bg-white" />
                                </a>
                            </div>
                            <!-- Slide Item -->
                            <div class="swiper-slide">
                                <a href="">
                                    <img src="assets/images/logo-th.png" alt=""
                                        class="w-full h-30 object-contain px-3 py-5 bg-white" />
                                </a>
                            </div>
                            <!-- Slide Item -->
                            <div class="swiper-slide">
                                <a href="">
                                    <img src="assets/images/logo-th.png" alt=""
                                        class="w-full h-30 object-contain px-3 py-5 bg-white" />
                                </a>
                            </div>
                            <!-- Slide Item -->
                            <div class="swiper-slide">
                                <a href="">
                                    <img src="assets/images/logo-th.png" alt=""
                                        class="w-full h-30 object-contain px-3 py-5 bg-white" />
                                </a>
                            </div>
                            <!-- Slide Item -->
                            <div class="swiper-slide">
                                <a href="">
                                    <img src="assets/images/logo-th.png" alt=""
                                        class="w-full h-30 object-contain px-3 py-5 bg-white" />
                                </a>
                            </div>
                            <!-- Slide Item -->
                            <div class="swiper-slide">
                                <a href="">
                                    <img src="assets/images/logo-th.png" alt=""
                                        class="w-full h-30 object-contain px-3 py-5 bg-white" />
                                </a>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="swiper-button-next shadow !text-white !bg-white hover:!bg-white/70 rounded-full p-2">
                        <svg class="w-4 h-4 text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg>
                    </div>
                    <div class="swiper-button-prev shadow !text-white !bg-white hover:!bg-white/70 rounded-full p-2">
                        <svg class="w-4 h-4 text-black" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                        </svg>
                    </div>
                </div>
            </div>
        </div>
        <div class="my-6 md:my-10">
            <div class="md:grid grid-cols-5 gap-3">
                <div id="category" class="col-span-1">
                    <!-- Toggle Button on Mobile -->
                    <button id="toggleSidebar" class="md:hidden mb-4">
                        <h3 class=" text-red-400 uppercase flex items-center gap-2"><svg
                                xmlns="http://www.w3.org/2000/svg" width="28" height="29" viewBox="0 0 28 29"
                                fill="none">
                                <path
                                    d="M9.625 7.8584C9.625 7.62633 9.71719 7.40377 9.88128 7.23968C10.0454 7.07559 10.2679 6.9834 10.5 6.9834H23.625C23.8571 6.9834 24.0796 7.07559 24.2437 7.23968C24.4078 7.40377 24.5 7.62633 24.5 7.8584C24.5 8.09046 24.4078 8.31302 24.2437 8.47712C24.0796 8.64121 23.8571 8.7334 23.625 8.7334H10.5C10.2679 8.7334 10.0454 8.64121 9.88128 8.47712C9.71719 8.31302 9.625 8.09046 9.625 7.8584ZM23.625 13.9834H10.5C10.2679 13.9834 10.0454 14.0756 9.88128 14.2397C9.71719 14.4038 9.625 14.6263 9.625 14.8584C9.625 15.0905 9.71719 15.313 9.88128 15.4771C10.0454 15.6412 10.2679 15.7334 10.5 15.7334H23.625C23.8571 15.7334 24.0796 15.6412 24.2437 15.4771C24.4078 15.313 24.5 15.0905 24.5 14.8584C24.5 14.6263 24.4078 14.4038 24.2437 14.2397C24.0796 14.0756 23.8571 13.9834 23.625 13.9834ZM23.625 20.9834H10.5C10.2679 20.9834 10.0454 21.0756 9.88128 21.2397C9.71719 21.4038 9.625 21.6263 9.625 21.8584C9.625 22.0905 9.71719 22.313 9.88128 22.4771C10.0454 22.6412 10.2679 22.7334 10.5 22.7334H23.625C23.8571 22.7334 24.0796 22.6412 24.2437 22.4771C24.4078 22.313 24.5 22.0905 24.5 21.8584C24.5 21.6263 24.4078 21.4038 24.2437 21.2397C24.0796 21.0756 23.8571 20.9834 23.625 20.9834ZM6.125 6.9834H4.375C4.14294 6.9834 3.92038 7.07559 3.75628 7.23968C3.59219 7.40377 3.5 7.62633 3.5 7.8584C3.5 8.09046 3.59219 8.31302 3.75628 8.47712C3.92038 8.64121 4.14294 8.7334 4.375 8.7334H6.125C6.35706 8.7334 6.57962 8.64121 6.74372 8.47712C6.90781 8.31302 7 8.09046 7 7.8584C7 7.62633 6.90781 7.40377 6.74372 7.23968C6.57962 7.07559 6.35706 6.9834 6.125 6.9834ZM6.125 13.9834H4.375C4.14294 13.9834 3.92038 14.0756 3.75628 14.2397C3.59219 14.4038 3.5 14.6263 3.5 14.8584C3.5 15.0905 3.59219 15.313 3.75628 15.4771C3.92038 15.6412 4.14294 15.7334 4.375 15.7334H6.125C6.35706 15.7334 6.57962 15.6412 6.74372 15.4771C6.90781 15.313 7 15.0905 7 14.8584C7 14.6263 6.90781 14.4038 6.74372 14.2397C6.57962 14.0756 6.35706 13.9834 6.125 13.9834ZM6.125 20.9834H4.375C4.14294 20.9834 3.92038 21.0756 3.75628 21.2397C3.59219 21.4038 3.5 21.6263 3.5 21.8584C3.5 22.0905 3.59219 22.313 3.75628 22.4771C3.92038 22.6412 4.14294 22.7334 4.375 22.7334H6.125C6.35706 22.7334 6.57962 22.6412 6.74372 22.4771C6.90781 22.313 7 22.0905 7 21.8584C7 21.6263 6.90781 21.4038 6.74372 21.2397C6.57962 21.0756 6.35706 20.9834 6.125 20.9834Z"
                                    fill="#FF4169" />
                            </svg>Danh mục sản phẩm</h3>
                    </button>


                    <!-- Sidebar -->
                    <aside id="sidebar"
                        class="fixed md:relative top-0 left-0 h-full w-full overflow-auto bg-gray-100 p-3 md:bg-transparent md:p-0 z-999 transform -translate-x-full md:translate-x-0 transition-transform duration-300">
                        <!-- Close Button -->
                        <div class="flex justify-between items-center">
                            <h3 class=" text-red-400 uppercase  flex items-center gap-2"><svg
                                    xmlns="http://www.w3.org/2000/svg" width="28" height="29" viewBox="0 0 28 29"
                                    fill="none">
                                    <path
                                        d="M9.625 7.8584C9.625 7.62633 9.71719 7.40377 9.88128 7.23968C10.0454 7.07559 10.2679 6.9834 10.5 6.9834H23.625C23.8571 6.9834 24.0796 7.07559 24.2437 7.23968C24.4078 7.40377 24.5 7.62633 24.5 7.8584C24.5 8.09046 24.4078 8.31302 24.2437 8.47712C24.0796 8.64121 23.8571 8.7334 23.625 8.7334H10.5C10.2679 8.7334 10.0454 8.64121 9.88128 8.47712C9.71719 8.31302 9.625 8.09046 9.625 7.8584ZM23.625 13.9834H10.5C10.2679 13.9834 10.0454 14.0756 9.88128 14.2397C9.71719 14.4038 9.625 14.6263 9.625 14.8584C9.625 15.0905 9.71719 15.313 9.88128 15.4771C10.0454 15.6412 10.2679 15.7334 10.5 15.7334H23.625C23.8571 15.7334 24.0796 15.6412 24.2437 15.4771C24.4078 15.313 24.5 15.0905 24.5 14.8584C24.5 14.6263 24.4078 14.4038 24.2437 14.2397C24.0796 14.0756 23.8571 13.9834 23.625 13.9834ZM23.625 20.9834H10.5C10.2679 20.9834 10.0454 21.0756 9.88128 21.2397C9.71719 21.4038 9.625 21.6263 9.625 21.8584C9.625 22.0905 9.71719 22.313 9.88128 22.4771C10.0454 22.6412 10.2679 22.7334 10.5 22.7334H23.625C23.8571 22.7334 24.0796 22.6412 24.2437 22.4771C24.4078 22.313 24.5 22.0905 24.5 21.8584C24.5 21.6263 24.4078 21.4038 24.2437 21.2397C24.0796 21.0756 23.8571 20.9834 23.625 20.9834ZM6.125 6.9834H4.375C4.14294 6.9834 3.92038 7.07559 3.75628 7.23968C3.59219 7.40377 3.5 7.62633 3.5 7.8584C3.5 8.09046 3.59219 8.31302 3.75628 8.47712C3.92038 8.64121 4.14294 8.7334 4.375 8.7334H6.125C6.35706 8.7334 6.57962 8.64121 6.74372 8.47712C6.90781 8.31302 7 8.09046 7 7.8584C7 7.62633 6.90781 7.40377 6.74372 7.23968C6.57962 7.07559 6.35706 6.9834 6.125 6.9834ZM6.125 13.9834H4.375C4.14294 13.9834 3.92038 14.0756 3.75628 14.2397C3.59219 14.4038 3.5 14.6263 3.5 14.8584C3.5 15.0905 3.59219 15.313 3.75628 15.4771C3.92038 15.6412 4.14294 15.7334 4.375 15.7334H6.125C6.35706 15.7334 6.57962 15.6412 6.74372 15.4771C6.90781 15.313 7 15.0905 7 14.8584C7 14.6263 6.90781 14.4038 6.74372 14.2397C6.57962 14.0756 6.35706 13.9834 6.125 13.9834ZM6.125 20.9834H4.375C4.14294 20.9834 3.92038 21.0756 3.75628 21.2397C3.59219 21.4038 3.5 21.6263 3.5 21.8584C3.5 22.0905 3.59219 22.313 3.75628 22.4771C3.92038 22.6412 4.14294 22.7334 4.375 22.7334H6.125C6.35706 22.7334 6.57962 22.6412 6.74372 22.4771C6.90781 22.313 7 22.0905 7 21.8584C7 21.6263 6.90781 21.4038 6.74372 21.2397C6.57962 21.0756 6.35706 20.9834 6.125 20.9834Z"
                                        fill="#FF4169" />
                                </svg> Danh mục sản phẩm</h3>
                            <button id="closeSidebar" class="md:hidden"><svg width="24" height="25" viewBox="0 0 24 25"
                                    fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M19.281 18.7193C19.3507 18.789 19.406 18.8717 19.4437 18.9628C19.4814 19.0538 19.5008 19.1514 19.5008 19.2499C19.5008 19.3485 19.4814 19.4461 19.4437 19.5371C19.406 19.6281 19.3507 19.7109 19.281 19.7806C19.2114 19.8502 19.1286 19.9055 19.0376 19.9432C18.9465 19.9809 18.849 20.0003 18.7504 20.0003C18.6519 20.0003 18.5543 19.9809 18.4632 19.9432C18.3722 19.9055 18.2895 19.8502 18.2198 19.7806L12.0004 13.5602L5.78104 19.7806C5.64031 19.9213 5.44944 20.0003 5.25042 20.0003C5.05139 20.0003 4.86052 19.9213 4.71979 19.7806C4.57906 19.6398 4.5 19.449 4.5 19.2499C4.5 19.0509 4.57906 18.86 4.71979 18.7193L10.9401 12.4999L4.71979 6.28055C4.57906 6.13982 4.5 5.94895 4.5 5.74993C4.5 5.55091 4.57906 5.36003 4.71979 5.2193C4.86052 5.07857 5.05139 4.99951 5.25042 4.99951C5.44944 4.99951 5.64031 5.07857 5.78104 5.2193L12.0004 11.4396L18.2198 5.2193C18.3605 5.07857 18.5514 4.99951 18.7504 4.99951C18.9494 4.99951 19.1403 5.07857 19.281 5.2193C19.4218 5.36003 19.5008 5.55091 19.5008 5.74993C19.5008 5.94895 19.4218 6.13982 19.281 6.28055L13.0607 12.4999L19.281 18.7193Z"
                                        fill="#2A3262" />
                                </svg>
                            </button>
                        </div>

                        <div class="">
                               
                                    @if (Model.ChildCategories != null && Model.ChildCategories.Any())
                                    {
                                    <ul class="mt-2 space-y-1">
                                            @foreach (var child in Model.ChildCategories)
                                            {
                                            var isActive = child.id == productid_id; // Chọn active nếu là nhóm con đang được chọn
                                            var isActiveChild = child.id == childrenId; // Kiểm tra nếu children_id đã được chọn
                                                <li>
                                                <a href="javascript:;"
                                                   class="menu_group_product block px-3 py-2 rounded cursor-pointer
                            @(isActive || isActiveChild ? "active text-purple-500 font-medium" : "text-gray-700 hover:text-purple-500")"
                                                   data-id="@child.id">
                                                    <span>»</span> @child.name
                                                </a>
                                                </li>
                                            }
                                        </ul>
                                    <div class="category_id" data-categoryid="0" style="display:none;"></div>
                                    }
                                    else
                                    {
                                        <p class="text-gray-400">Không có danh mục con</p>
                                    }

                                  

                            


                            <!-- Giá -->
                           <div class="mt-6">
                                <h3 class="font-medium text-red-400 uppercase  flex items-center gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="28" height="29" viewBox="0 0 28 29" fill="none">
                                        <path d="M16.625 13.9834H14.875V6.9834H15.75C16.6783 6.9834 17.5685 7.35215 18.2249 8.00852C18.8813 8.6649 19.25 9.55514 19.25 10.4834C19.25 10.7155 19.3422 10.938 19.5063 11.1021C19.6704 11.2662 19.8929 11.3584 20.125 11.3584C20.3571 11.3584 20.5796 11.2662 20.7437 11.1021C20.9078 10.938 21 10.7155 21 10.4834C20.9986 9.09146 20.445 7.75694 19.4607 6.77269C18.4765 5.78843 17.1419 5.23485 15.75 5.2334H14.875V3.4834C14.875 3.25133 14.7828 3.02877 14.6187 2.86468C14.4546 2.70059 14.2321 2.6084 14 2.6084C13.7679 2.6084 13.5454 2.70059 13.3813 2.86468C13.2172 3.02877 13.125 3.25133 13.125 3.4834V5.2334H12.25C10.8576 5.2334 9.52226 5.78652 8.53769 6.77109C7.55312 7.75565 7 9.09101 7 10.4834C7 11.8758 7.55312 13.2111 8.53769 14.1957C9.52226 15.1803 10.8576 15.7334 12.25 15.7334H13.125V22.7334H11.375C10.4467 22.7334 9.5565 22.3646 8.90013 21.7083C8.24375 21.0519 7.875 20.1617 7.875 19.2334C7.875 19.0013 7.78281 18.7788 7.61872 18.6147C7.45462 18.4506 7.23206 18.3584 7 18.3584C6.76794 18.3584 6.54538 18.4506 6.38128 18.6147C6.21719 18.7788 6.125 19.0013 6.125 19.2334C6.12645 20.6253 6.68004 21.9599 7.66429 22.9441C8.64854 23.9284 9.98306 24.482 11.375 24.4834H13.125V26.2334C13.125 26.4655 13.2172 26.688 13.3813 26.8521C13.5454 27.0162 13.7679 27.1084 14 27.1084C14.2321 27.1084 14.4546 27.0162 14.6187 26.8521C14.7828 26.688 14.875 26.4655 14.875 26.2334V24.4834H16.625C18.0174 24.4834 19.3527 23.9303 20.3373 22.9457C21.3219 21.9611 21.875 20.6258 21.875 19.2334C21.875 17.841 21.3219 16.5057 20.3373 15.5211C19.3527 14.5365 18.0174 13.9834 16.625 13.9834ZM12.25 13.9834C11.3217 13.9834 10.4315 13.6146 9.77513 12.9583C9.11875 12.3019 8.75 11.4117 8.75 10.4834C8.75 9.55514 9.11875 8.6649 9.77513 8.00852C10.4315 7.35215 11.3217 6.9834 12.25 6.9834H13.125V13.9834H12.25ZM16.625 22.7334H14.875V15.7334H16.625C17.5533 15.7334 18.4435 16.1021 19.0999 16.7585C19.7563 17.4149 20.125 18.3051 20.125 19.2334C20.125 20.1617 19.7563 21.0519 19.0999 21.7083C18.4435 22.3646 17.5533 22.7334 16.625 22.7334Z" fill="#FF4169" />
                                     </svg>Giá</h3>
                                 <div class="flex items-center gap-2 mt-2">
                                        <input type="text" id="priceFrom" placeholder="Từ" class="w-full border rounded p-2 border-transparent bg-white" />
                                     <span><svg xmlns="http://www.w3.org/2000/svg" width="20" height="21" viewBox="0 0 20 21" fill="none">
                                         <path d="M9.41016 4.43597C9.73559 4.11054 10.2634 4.11054 10.5889 4.43597L16.4219 10.269C16.7473 10.5944 16.7473 11.1223 16.4219 11.4477L10.5889 17.2807C10.2634 17.6061 9.73559 17.6061 9.41016 17.2807C9.08515 16.9553 9.08515 16.4283 9.41016 16.103L13.8213 11.6918H4.16602C3.70604 11.6917 3.33318 11.3188 3.33301 10.8588C3.33301 10.3987 3.70593 10.025 4.16602 10.0248H13.8203L9.41016 5.61468C9.08477 5.2893 9.08488 4.76142 9.41016 4.43597Z" fill="#919191" />
                                     </svg></span>
                                        <input type="text" id="priceTo" placeholder="Đến" class="w-full border rounded p-2 border-transparent bg-white" />
                                 </div>
                             </div>


                            <!-- Thương hiệu -->

                             @* @await Component.InvokeAsync("LabelList", new { labeltype = "product" }) *@
                           
                        </div>
                    </aside>


                </div>
                @* ListProduct *@
                <div class="col-span-4">
                        @if(Model.Products != null){
                        <div class="grid lg:grid-cols-4 md:grid-cols-3 grid-cols-2 gap-3 component-product-list">
                            @Html.Partial("~/Views/Shared/Components/Product/ProductListViewComponent.cshtml", Model.Products)
                        </div>
                        }
                        else
                        {
                            <!-- ✅ Không có sản phẩm nào -->
                            <div class="w-full flex items-center justify-center py-10 text-gray-500 text-center text-lg" id="no-products-message">
                                Không tìm thấy sản phẩm nào 🥲
                            </div>
                        } 
                       
                    
                         <div class="flex justify-center mt-5">
                            <button class="text-color-base font-normal" id="load-more-btn" onclick="home_product.loadMore()">
                                Xem thêm
                            </button>

            </div>
                  </div>
                 <!-- Nút Xem Thêm -->
              

            </div>
        </div>
    </div>
</section>


<!-- END DANH SACH SAN PHAM -->

    </main>
<script>
   window.AppConfig = {
        parentGroupId: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.SelectedGroupId)),
        childrenId: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(ViewData["ChildrenId"]))
    };
</script>
